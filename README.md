<img align="right" width="300" src="https://raw.githubusercontent.com/AcademicDog/myresource/master/usage.png" alt="copy URL to clipboard" />

本项目fork至 [https://github.com/AcademicDog/onmyoji_bot/](https://github.com/AcademicDog/onmyoji_bot/) 并做出了以下修改：

* 新增打包相关配置
* 新增虚拟环境的兼容
* 功能新增


### 特性

- 御魂
  - 单人御魂
  - 作为司机组队御魂，自动邀请
  - 作为乘客组队御魂，自动接受邀请
  - 双开御魂
- 业原火
  - 自动刷贪、嗔、痴卷
- 御灵
  - 自动刷御灵
- 探索
  - 完成探索，识别经验怪，支持自动换狗粮
- 其他
  - 在战斗过程中，该脚本会自动拒绝所有悬赏封印的邀请。
  - 如果60s程序没有任何操作（卡机、体力空等），视为体力用光，为了保护加成，自动关闭YYS。
  - 该脚本仅使用了画面找色，鼠标后台点击的函数，完全模拟人类玩家行为，没有使用任何内存读写函数。在敏感位置添加了均匀分布的随机时间漂移，和随机坐标漂移。**但仍然可能存在使用风险**。

### 使用环境

> 阴阳师PC版客户端，默认分辨率(1136x640)
>
> Windows 10和Windows 7，屏幕(1920x1080)，显示设置100%
>
> 如需运行源码，需要Python3 32位
* * *

# 使用方法

### 单人刷御魂/业原火/御灵

1.  打开本工具，切换至御魂选项卡；

1.  游戏中进入御魂/业原火/御灵主界面（就是有“挑战”按钮的页面），请提前备好式神并**锁定阵容**；

1.  点击本工具的“开始”按钮。

### 组队刷御魂

1.  打开本工具，切换至御魂选项卡，根据自身情况选择“单人司机”或者“单人乘客”；

1.  游戏中进入组队页面，请提前备好式神并**锁定阵容**；

1.  点击本工具的“开始”按钮。

### 单人探索

1.  打开本工具，切换至探索选项卡；

1.  在游戏种提前将狗粮队长放在阴阳师中间，并且**取消锁定阵容**；

1.  游戏中点开需要探索的章节（就是有“探索”按钮的页面）；

1.  点击本工具的“开始”按钮。

* * *

# 注意事项

1.  要求使用Windows 10或Windows 7，屏幕(1920x1080)，显示设置100%”。

1.  当使用 Windows 7 系统时，需要调整系统的画面设置：把主题调为最丑最挫的那个。在 Windows 10 系统中，不需要调整系统画面设置。

1.  需要关闭电脑的自动息屏/休眠。

1.  窗口现在可以完全后台，可以被遮挡，但是**不能最小化**。

1.  不要开启游戏中的“模型描边”。

1.  不要移动游戏窗口。

1.  当使用高分辨率屏幕时，在阴阳师客户端程序兼容性选项里，不要勾选“替代高DPI缩放行为”，这个选项应该是默认不勾选的。

1.  exe文件可能被杀毒软件隔离，若被隔离需自行恢复并添加到信任区

1.  命令行模式下运行脚本时不要左键点击命令行以免选中文本，这可能导致进程暂停引起其他问题，如不小心暂停，按空格才能继续脚本。（也可以在窗口属性面板处关闭命令行窗口的快速编辑模式，以避免不小心中断）

1.  需要锁定阵容。

1.  刷御魂，房主需要在房间内开启脚本，乘客在房间内或战斗中开启均可。

1.  中途有事暂停记得关闭脚本，因为操作超时脚本会把游戏关闭。

1.  不建议使用刷探索，目前经验怪的识别成功度不高。N卡满级自动换N卡时是会拖动N卡40%进度条再拖放，所以用户需要关闭式神折叠。刷2星1级白蛋则需要开启式神折叠。刷高级白蛋目前有bug，自动换素材有问题。

1.  探索换狗粮的时候，如果是关闭了滚动换卡，换上第一个N卡，因此注意**不要**对N卡点击“喜欢”，导致反复换上一个满级的狗粮。

1.  标记式神功能会标记左边第二位式神，需要关闭式神技能动画特写

1.  如果不想安装运行环境，可以访问releases下载最新已[编译]版本，该版本有图形界面，同时注意.exe文件和/img文件夹应该放在同一目录后再运行。

# 运行未编译脚本
安装python3.7.0
安装依赖
~~~
pip install -r requirements.txt
~~~
运行run.bat（若有使用虚拟环境，编辑runInVirtualEnv.bat内的虚拟环境路径，再运行bat）

# 打包说明
安装pyinstaller，若有使用虚拟环境，需要在虚拟环境中安装再打包
~~~
pip install pyinstaller
~~~
打包exe
~~~
pyinstaller -F -w ui.py
~~~
或
~~~
pyinstaller -F omj.py
~~~

注意，有个坑！！！
> exe打包过程若无报错，但是打包出的exe打不开（例如报错：文件所在的卷已被更改,打开的文件不再有效），可以关闭杀毒软件再打包